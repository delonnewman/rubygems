= <nowiki>RubyGems</nowiki> User's Guide =

== Background ==

Welcome to the new world of RubyGems.  RubyGems is a vision that started (in discussion) at 
RubyConf 2001.  Unfortunately, like many open-source projects, it was never quite realized.
At RubyConf 2003, the specter of RubyGems was again revived, and a few enterprising Rubyist
were just tired of the discussion and over the weekend of RubyConf got the initial skeleton
of RubyGems created, and has now advanced to this initial release.

So, enough of that, what is RubyGems?  Well, that is a great question, because RubyGems is
a lot of things.   Its a way to package Ruby libraries/applications for distribution, its a
distribution manager, its a package manager.  RubyGems brings to the world of Ruby a 
very valuable capability--the ability to manage concurrent versions of libraries and dependencies
between those libraries.  This last aspect of RubyGems is one of the most important to the 
end user, because its value is continuous as you use and program Ruby, but to understand its 
impact an explanation of how Ruby manages libraries is in order.

== How Ruby Manages Packages ==

There are two main ways that you can load files into Ruby script you are writing.  The first
is the '''require''' function, the second is '''load'''.  Both of these methods search out and 
load a Ruby source or native library file, but '''require''' will do so only once per session, 
while '''load''' will reload the file each call.  The way in which Ruby finds files to load
is what will be discussed in this section.  Within the Ruby interpreter there is a global variable
defined '''$LOAD_PATH''' that holds the paths that Ruby searches (in order) for the file that
you request.  For example, with Ruby 1.8 on OS X the $LOAD_PATH looks like this:

  /usr/local/lib/ruby/site_ruby/1.8
  /usr/local/lib/ruby/site_ruby/1.8/powerpc-darwin
  /usr/local/lib/ruby/site_ruby
  /usr/local/lib/ruby/1.8
  /usr/local/lib/ruby/1.8/powerpc-darwin
  .

Starting from the bottom of this list, we see the core Ruby directories (../ruby/1.8,
../ruby/1.8/powerpc-darwin) which contain all the libraries that the Ruby distribution
ships with.  The upper three paths (../site_ruby) are where third party libraries are 
installed.  Every time you install a Ruby libary that you download, the Ruby/native 
files are installed in site_ruby.  The reason for this is that these paths are in the 
$LOAD_PATH, and are thus searched when you do a '''require''' or '''load'''.  The problem
with this is all the files from different third-party libaries are all merged into this
single directory structure, which makes it difficult to remove libraries (you have to 
manually delete the files that you think were part of a library), and impossible to install
multiple versions of a single library (because the files would overwrite each other).

This is where RubyGems enters the picture.  What RubyGems does is install each library (and
version) into its own unique directory instead of into the site_ruby directory. These 
directories are located along side the ../ruby/1.8 and ../ruby/site_ruby directories:

  /usr/local/lib/ruby/'''gems/1.8'''

In addtion to installing each gem in a directory under this base directory, when
you require a particular gem (see usage below), the RubyGems infrastructure modifies the
$LOAD_PATH to include that gems' unique directory.  For example, if you require the jabber4r
gem (v 0.7.0) the $LOAD_PATH would then look like this:

  /usr/local/lib/ruby/gems/1.8/jabber4r-0.7.0/lib
  /usr/local/lib/ruby/site_ruby/1.8
  /usr/local/lib/ruby/site_ruby/1.8/powerpc-darwin
  /usr/local/lib/ruby/site_ruby
  /usr/local/lib/ruby/1.8
  /usr/local/lib/ruby/1.8/powerpc-darwin
  .

So, since RubyGems is managing this $LOAD_PATH dynamically, gems can be added, removed and
multiple version can exist on your hard drive at the same time, and different scripts can
require different versions as needed.  Hopefully this explains one of the main benefits of
using RubyGems, but the benefits don't stop there.  RubyGems also allows you to install, 
uninstall, remotely install (over the Net) and search for gems.  As a developer it is quite
easy to turn an existing library into a gem, and post it for distribution to the Ruby
community, so we believe that the RubyGems approach will grow in popularity very quickly.

The next sections document downloading and installing the RubyGems library as well as 
managing the gems on your computer, and then concludes with how to use RubyGems.

== Installing the <nowiki>RubyGems</nowiki> library ==

This section describes installing the RubyGems library itself.  This may not be necessary in 
furture versions of Ruby if/when RubyGems is included in the distribution.  Installation is 
fairly simple.

* [http://rubyforge.org/project/showfiles.php?group_id=126 Download] <nowiki>RubyGems</nowiki>
* Unpack the distribution (zip or tar.gz)
* cd rubygems-version.number
* ruby install.rb (NOTE:  You'll need to have write access to your Ruby site_library directory).

The contents of the lib directory are copied into site_ruby, and the contents of the bin directory
are copied into the bin directory that holds ruby, irb, etc.

If you have a non-standard Ruby installation and would like to install <nowiki>RubyGems</nowiki> 
to an alternate location, you can recursively copy the contents of "lib" to the desired location 
and add this location to Ruby's LOAD_PATH.

== Installing and Uninstalling Gems ==

=== Installing a Gem ===

The easiest way to install a gem is to actually run the gem itself.  Each Ruby Gem is a valid 
Ruby script which, when executed, will extract and install itself.  The command is, simply:

  % ruby myproject-0.0.1.gem [--help | --dir=<dirname> | --force]

By default, <nowiki>RubyGems</nowiki> maintains installed content in a central directory 
located off of the root of your Ruby installation.  The <b>--dirname</b> command-line option 
allows you to change this default installation location, which would be useful, for example, 
if you were on a computer for which you lacked write access to the standard Ruby distribution.

The <b>--force</b> option disables dependency checking.  By default, <nowiki>RubyGems</nowiki> 
will fail to install a Gem if the required dependencies are not already present in your Gem 
directory.

Alternatively, you can use the <b>gem</b> command with these same plus the <b>--install</b> option:

  % gem --install myproject-0.0.1.gem [--dir=<dirname> | --force]

=== Uninstalling a Gem ===

To uninstall a gem, you can simply run the following command:

  % gem --uninstall myproject [--version=<versionnumber>]

If run without the version number, and only one match for the gem name is found, that gem will 
be uninstalled.  If multiple matches are found, the uninstaller will display a list of installed 
versions of the specified Gem and ask you to select the one to uninstall.  When the 
<b>--version</b> option is used, only the specified version will be removed, or an error will 
be displayed if it is not found.

=== Remote Installation ===

<nowiki>RubyGems</nowiki> supports installation of packages via a network.  The 
<nowiki>RubyGems</nowiki> distribution comes with a default set of package "sources", 
which are installed as a Ruby Gem during the <b>install.rb</b> process outlined above.  
<nowiki>RubyGems</nowiki> uses HTTP for both discovery and download of gem files.

Remote installation of a gem can be performed as follows:

  % gem --remote-install <gemname> [--version=<gemversion>]

This command will download the requested gem and all of its dependencies (recursively) 
and install them.  

Under normal operating conditions, you will not need to worry about the gem "sources", since 
it's managed internally to the <nowiki>RubyGems</nowiki> distribution and upgradable as a gem 
itself.  However, if you <b>do</b> need to override or append to your sources list, that can 
be accomplished as in the following:

   FIXME: This isn't possible yet.

=== Searching for Gems ===

You can search the online repository of which gems are available.  To use this just type:

  % gem --search <string>

This will match <string> against the Sources index of available gems and report gems that
match the search criteria.

You can also see the gems available at RubyForge through a web browser:

  http://gems.rubyforge.org/gems

Or get the YAML index in your web browser:

  http://gems.rubyforge.org/yaml

== Navigating Gems on Your Computer ==

To get a list of the gems you have installed you use the gem command:

  % gem --list

Results in a list of gems:

  sources-0.0.1
  jabber4r-0.7.0

If you want more information on a particular gem, you can just type the following command
and it will return the gem specification in YAML format.

  % gem --info <gemname> [--version=<gemversion>]

Here is an example:

  % gem --info jabber4r
  
    --- !ruby/object:Gem::Specification 
    rubygems_version: "1.0"
    name: jabber4r
    version: !ruby/object:Gem::Version 
      version: 0.7.0
    date: 2004-03-13 20:48:04.925855 -05:00
    platform: 
    summary: Jabber4r is a pure-Ruby Jabber client library
    require_paths: 
      - lib
    files: 
      - lib/jabber4r
      - lib/jabber4r/jabber4r.rb
      - lib/jabber4r/jid.rb
      - lib/jabber4r/LICENSE.txt
      - lib/jabber4r/protocol.rb
      - lib/jabber4r/rexml_1.8_patch.rb
      - lib/jabber4r/roster.rb
      - lib/jabber4r/session.rb
      - lib/jabber4r/vcard.rb
    autorequire: jabber4r/jabber4r
    author: Richard Kilmer
    email: rich@infoether.com
    homepage: http://jabber4r.rubyforge.org
    rubyforge_project: jabber4r
    has_rdoc: true
    requirements: 
      - Jabber server

== Creating Gems ==	

Creating gems is really simple.  If you are a library author, or just want to make a Gem of
some Ruby code you are writing, see the <a href="DevDoc.html">Developer's Documentation</a>.

== Using Gems in your Ruby Scripts ==

Now we get down to the use of RubyGems in your scripts.  If a script wants access to RubyGems,
it must first require the rubygems libarary:

  require 'rubygems'

This makes a new root level method available 'require_gem' which has the following syntax:

  require_gem "gem_name", [version_requirement]

Note that the version_requirement information is optional, and if left off RubyGems will attempt 
to load the latest version of an available gem (if multiple versions are present).  A version 
can be any sequence of number separated by periods.  Versions are specified as strings.

  example:
  "0.3"
  "1.34.23"

A version requirement is a version string prefaced with a operator.  If an operator
is not specified in a version requirement string, it assumes an equal "=" operator.
The operator can be one of the following:

  =  Equals version
  != Not equal to version
  >  Greater than version
  <  Less than version
  >= Greater than or equal to
  <= Less than or equal to

  example:
  "> 1.1"
  "= 4.56.4"  

When a gem is 'required' RubyGems tries to find a gem that meets the version requirements.
Additionally, RubyGems recursively require_gem's all gems that the gem you are loading is
dependant on.  So, if you loaded a gem (amrita) and it was dependant on another gem (strscan),
the strscan gem would be loaded first, then the amrita gem would be loaded.  When the gem
is loaded (as well as its dependencies), and if that gem has an 'autorequire' statement in its
gemspec, you should be able to just use the library as if you loaded it with a traditional
'require' command.

So that is all there is to using gems.  You just 'require' the rubygems library, then 'gem_require'
each gem you want to use.  From that point on, you write Ruby just as you always have (accessing
modules, classes, etc.).

== Conclusion ==

That's it for now.  We hope you find RubyGems easy to useful and easy to use.  Please provide 
feedback to the rubygems team, and report bugs, suggestions, etc at the rubygems project site:  

  [http://rubyforge.org/tracker/?group_id=126 RubyGems Bugs/Suggestions]
  [http://rubyforge.org/projects/rubygems RubyGems Main Project Page]

Or visit the RubyGems project wiki at:

  [http://rubygems.rubyforge.org/ RubyGems Wiki]

Thanks for your support, and let's make this RubyGems effort successful!

- ''The RubyGems Team''